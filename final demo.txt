

Test Case 1: Matching numeric columns
  Expected Audit Table: All values (NULLs, MIN, MAX, COUNT, HASH) should match
  Expected Error Table: None

Test Case 2: Mismatching null count
  Expected Audit Table: SRC_NULL_COUNT != TGT_NULL_COUNT for column AMOUNT
  Expected Error Table: None

Test Case 3: Mismatching string lengths
  Expected Audit Table: SRC_MAX_LENGTH != TGT_MAX_LENGTH for column NAME
  Expected Error Table: None

Test Case 4: Column missing in target
  Expected Audit Table: No audit data for missing column AGE
  Expected Error Table: Error logged for missing column in COLUMN_PROFILE_ERRORS

Test Case 5: Table missing in target
  Expected Audit Table: None
  Expected Error Table: Error logged for missing table in COLUMN_PROFILE_ERRORS

Test Case 6: Unsupported data type for hash (FLOAT)
  Expected Audit Table: All stats except HASH recorded; HASH marked as 'SKIPPED'
  Expected Error Table: None

Test Case 7: Hash mismatch
  Expected Audit Table: MD5_HASH_SRC != MD5_HASH_TGT for AMOUNT
  Expected Error Table: None

===== TEST CASE SQL SCRIPTS =====

USE DATABASE SRC_DB;
USE SCHEMA SRC_SCHEMA;

USE DATABASE TGT_DB;
USE SCHEMA TGT_SCHEMA;

-- Test Case 1: Matching numeric columns
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_MATCH_NUMERIC;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_MATCH_NUMERIC;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_MATCH_NUMERIC (ID INT, AMOUNT NUMBER);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_MATCH_NUMERIC VALUES (1, 100), (2, 200), (3, 300);

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_MATCH_NUMERIC (ID INT, AMOUNT NUMBER);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_MATCH_NUMERIC VALUES (1, 100), (2, 200), (3, 300);



-- Test Case 2: Mismatching null count
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_NULL_MISMATCH;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_NULL_MISMATCH;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_NULL_MISMATCH (ID INT, AMOUNT NUMBER);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_NULL_MISMATCH VALUES (1, NULL), (2, 200), (3, 300);

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_NULL_MISMATCH (ID INT, AMOUNT NUMBER);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_NULL_MISMATCH VALUES (1, 100), (2, 200), (3, 300);



-- Test Case 3: Mismatching string lengths
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_STR_LEN;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_STR_LEN;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_STR_LEN (ID INT, NAME VARCHAR);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_STR_LEN VALUES (1, 'A'), (2, 'BB'), (3, 'CCC');

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_STR_LEN (ID INT, NAME VARCHAR);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_STR_LEN VALUES (1, 'A'), (2, 'BB'), (3, 'DDDD');



-- Test Case 4: Column missing in target
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_COL_MISSING;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_COL_MISSING;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_COL_MISSING (ID INT, AGE INT);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_COL_MISSING VALUES (1, 20), (2, 30);

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_COL_MISSING (ID INT);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_COL_MISSING VALUES (1), (2);



-- Test Case 5: Table missing in target
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_TABLE_MISSING;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_TABLE_MISSING (ID INT, NAME VARCHAR);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_TABLE_MISSING VALUES (1, 'A'), (2, 'B');

-- TGT table is intentionally not created



-- Test Case 6: Unsupported data type for hash (FLOAT)
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_FLOAT;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_FLOAT;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_FLOAT (ID INT, SCORE FLOAT);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_FLOAT VALUES (1, 99.5), (2, 88.0);

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_FLOAT (ID INT, SCORE FLOAT);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_FLOAT VALUES (1, 99.5), (2, 88.0);



-- Test Case 7: Hash mismatch
DROP TABLE IF EXISTS SRC_DB.SRC_SCHEMA.TEST_HASH_DIFF;
DROP TABLE IF EXISTS TGT_DB.TGT_SCHEMA.TEST_HASH_DIFF;

CREATE TABLE SRC_DB.SRC_SCHEMA.TEST_HASH_DIFF (ID INT, AMOUNT NUMBER);
INSERT INTO SRC_DB.SRC_SCHEMA.TEST_HASH_DIFF VALUES (1, 100), (2, 200), (3, 300);

CREATE TABLE TGT_DB.TGT_SCHEMA.TEST_HASH_DIFF (ID INT, AMOUNT NUMBER);
INSERT INTO TGT_DB.TGT_SCHEMA.TEST_HASH_DIFF VALUES (1, 100), (2, 999), (3, 300);



===== SOURCE & TARGET TEST DATA (CSV Preview) =====

-- Source Data: TEST_MATCH_NUMERIC
ID,AMOUNT
1,100
2,200
3,300


-- Source Data: TEST_NULL_MISMATCH
ID,AMOUNT
1,
2,200
3,300


-- Source Data: TEST_STR_LEN
ID,NAME
1,A
2,BB
3,CCC


-- Source Data: TEST_COL_MISSING
ID,AGE
1,20
2,30


-- Source Data: TEST_TABLE_MISSING
ID,NAME
1,A
2,B


-- Source Data: TEST_FLOAT
ID,SCORE
1,99.5
2,88.0


-- Source Data: TEST_HASH_DIFF
ID,AMOUNT
1,100
2,200
3,300


-- Target Data: TEST_MATCH_NUMERIC
ID,AMOUNT
1,100
2,200
3,300


-- Target Data: TEST_NULL_MISMATCH
ID,AMOUNT
1,100
2,200
3,300


-- Target Data: TEST_STR_LEN
ID,NAME
1,A
2,BB
3,DDDD


-- Target Data: TEST_COL_MISSING
ID,AGE
1
2


-- Target Data: TEST_FLOAT
ID,SCORE
1,99.5
2,88.0


-- Target Data: TEST_HASH_DIFF
ID,AMOUNT
1,100
2,999
3,300


